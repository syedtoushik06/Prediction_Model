---
output:
  html_document:
    self_contained: true
    theme: null
    css: styles.css
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  message = FALSE, 
  warning = FALSE, 
  fig.align = "center",
  fig.width = 8,
  fig.height = 3.5
)

# Load packages
library(ggplot2)
library(dplyr)
library(gridExtra)
library(caret)
library(Metrics)
library(scales)
library(grid)
library(hexbin)
library(knitr)
library(kableExtra)

# Load data
movies <- read.csv("Dataset.csv")
colnames(movies) <- c("Title", "Rating", "Votes")
movies$Rating <- as.numeric(movies$Rating)
movies$Votes <- as.numeric(movies$Votes)
```

```{css, echo=FALSE}
@media print {
  @page {
    size: letter;
    margin: 0.3in;
  }
  body {
    font-size: 9pt;
    line-height: 1.2;
  }
  h1 {
    font-size: 13pt;
    margin: 8px 0 4px 0;
    page-break-after: avoid;
  }
  h2 {
    font-size: 11pt;
    margin: 6px 0 3px 0;
    page-break-after: avoid;
  }
  .no-break {
    page-break-inside: avoid;
  }
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 9pt;
  line-height: 1.3;
  max-width: 100%;
  margin: 0 auto;
  padding: 0.3in;
}

.header-box {
  background: linear-gradient(135deg, #2874A6 0%, #1F618D 100%);
  color: white;
  padding: 12px 20px;
  border-radius: 8px;
  text-align: center;
  margin-bottom: 10px;
}

.header-box h1 {
  margin: 0;
  font-size: 18pt;
  font-weight: 700;
}

.header-box p {
  margin: 4px 0 0 0;
  font-size: 9pt;
  opacity: 0.95;
}

.info-row {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 10px;
  font-size: 8.5pt;
}

.info-box {
  flex: 1;
  background: #EBF5FB;
  padding: 8px 12px;
  border-radius: 6px;
  border-left: 3px solid #2874A6;
}

.two-col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin: 10px 0;
}

.stat-box {
  background: #F8F9F9;
  padding: 8px 12px;
  border-radius: 6px;
  border-left: 3px solid #F39C12;
}

.equation-box {
  background: #FCF3CF;
  padding: 10px 15px;
  border-radius: 6px;
  text-align: center;
  margin: 10px 0;
  border-left: 4px solid #F39C12;
  font-size: 10pt;
}

h1, h2 {
  color: #2874A6;
  margin: 10px 0 5px 0;
}

table {
  width: 100%;
  font-size: 8pt;
  margin: 8px 0;
  border-collapse: collapse;
}

table th {
  background: #2874A6;
  color: white;
  padding: 4px 6px;
  text-align: center;
}

table td {
  padding: 3px 6px;
  border-bottom: 1px solid #ddd;
  text-align: center;
}

table tr:nth-child(even) {
  background: #F8F9F9;
}

.findings {
  background: #E8F6F3;
  padding: 10px 15px;
  border-radius: 6px;
  border-left: 4px solid #27AE60;
  margin: 10px 0;
  font-size: 9pt;
}

.findings ul {
  margin: 5px 0;
  padding-left: 20px;
}

.findings li {
  margin: 3px 0;
}

img {
  max-width: 100%;
  height: auto;
}
```

<div class="header-box">
<h1><span style="color: #FFD700;">ðŸŽ¬ Prediction Model: IMDB Rating & Movie Popularity</span></h1>
<p><strong>Statistical Analysis Report</strong> | Predictive Modeling with Linear Regression</p>
</div>

<div class="info-row">
<div class="info-box">
<strong>Student:</strong> Syed Toushik Hossain<br>
<strong>Institute:</strong> IHE, University of Dhaka
</div>
<div class="info-box">
<strong>Course:</strong> Statistics I (HE 103)<br>
<strong>Instructor:</strong> Ashraful K. Abir
</div>
<div class="info-box">
<strong>Session:</strong> 1st Year, 1st Semester<br>
<strong>Date:</strong> `r format(Sys.Date(), '%B %d, %Y')`
</div>
</div>

## ðŸ“Š Descriptive Statistics

### ðŸ“‹ Dataset Snapshot

```{r dataset-snapshot}
# Display first 10 rows of the dataset
kable(head(movies, 10), 
      col.names = c("Movie Title", "IMDB Rating", "Number of Votes"),
      align = c("l", "c", "r"),
      caption = "First 10 Movies from the Dataset") %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = FALSE,
                font_size = 8)
```

### ðŸ“ˆ Summary Statistics

<div class="two-col">
<div class="stat-box">
<strong>IMDB Ratings</strong><br>
Mean: `r round(mean(movies$Rating), 2)` | Median: `r round(median(movies$Rating), 2)`<br>
SD: `r round(sd(movies$Rating), 2)` | Range: `r min(movies$Rating)`â€“`r max(movies$Rating)`
</div>
<div class="stat-box">
<strong>Votes (Popularity)</strong><br>
Mean: `r comma(round(mean(movies$Votes)))` | Median: `r comma(round(median(movies$Votes)))`<br>
SD: `r comma(round(sd(movies$Votes)))` | Range: `r comma(min(movies$Votes))`â€“`r comma(max(movies$Votes))`
</div>
</div>

```{r correlation}
correlation <- round(cor(movies$Rating, movies$Votes), 3)
```

<div style="background: #FFF9C4; padding: 10px 15px; border-radius: 6px; border-left: 4px solid #F57C00; margin: 10px 0; font-weight: bold; color: #E65100;">
<strong>Correlation (r): `r correlation`</strong> â€“ Strong positive relationship between rating and popularity.
</div>

## ðŸŽ¨ Graphical Analysis

```{r plots, fig.height=3.5, fig.width=8}
p1 <- ggplot(movies, aes(x = Rating, y = Votes)) +
  geom_hex(bins = 25) +
  geom_smooth(method = "lm", color = "#FF1744", se = TRUE, linewidth = 2, alpha = 0.3) +
  scale_fill_gradient(low = "#64B5F6", high = "#0D47A1", name = "Count") +
  scale_y_continuous(labels = comma) +
  labs(title = "IMDB Rating vs Votes (Hexbin Density)", x = "IMDB Rating", y = "Number of Votes") +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#0D47A1"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text = element_text(size = 9, color = "#424242"),
    legend.key.size = unit(0.5, "cm"),
    legend.title = element_text(face = "bold", size = 9),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

movies$RatingGroup <- cut(movies$Rating, breaks = seq(7, 10, by = 0.5),
                          include.lowest = TRUE, right = FALSE)
p2 <- ggplot(movies, aes(x = RatingGroup, y = Votes)) +
  geom_boxplot(fill = "#FFB300", color = "#E65100", outlier.colour = "#D32F2F", 
               outlier.size = 1.5, alpha = 0.8, linewidth = 0.8) +
  scale_y_continuous(labels = comma) +
  labs(title = "Votes Distribution by Rating Group", x = "IMDB Rating Group", y = "Number of Votes") +
  theme_minimal(base_size = 10) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 9, color = "#424242"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#E65100"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text.y = element_text(size = 9, color = "#424242"),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

grid.arrange(p1, p2, ncol = 2)
```

## ðŸ”® Predictive Model & Diagnostics

```{r modeling}
set.seed(123)
train_index <- createDataPartition(movies$Votes, p = 0.8, list = FALSE)
train_data <- movies[train_index, ]
test_data <- movies[-train_index, ]
model <- lm(Votes ~ Rating, data = train_data)
predictions <- predict(model, newdata = test_data)
test_data$Predicted <- predictions
test_data$Residuals <- test_data$Votes - predictions

intercept <- round(coef(model)[1], 2)
slope <- round(coef(model)[2], 2)
r_squared <- round(summary(model)$r.squared, 3)
rmse_value <- comma(round(rmse(test_data$Votes, predictions), 0))
mae_value <- comma(round(mae(test_data$Votes, predictions), 0))
```

<div class="equation-box">
<strong>Prediction Equation:</strong> Votes = `r intercept` + `r slope` Ã— Rating<br>
<strong>RÂ² = `r r_squared`</strong> | RMSE = `r rmse_value` | MAE = `r mae_value`
</div>

```{r diagnostics, fig.height=3.5, fig.width=8}
p3 <- ggplot(test_data, aes(x = Votes, y = Predicted)) +
  geom_point(aes(color = abs(Residuals)), size = 2.5, alpha = 0.8) +
  geom_abline(slope = 1, intercept = 0, color = "#D32F2F", linetype = "dashed", linewidth = 1.5) +
  scale_color_gradient(low = "#00C853", high = "#FF1744", name = "Absolute\nError", labels = comma) +
  scale_x_continuous(labels = comma) + scale_y_continuous(labels = comma) +
  labs(title = "Actual vs Predicted Votes", x = "Actual Votes", y = "Predicted Votes") +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#1976D2"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text = element_text(size = 9, color = "#424242"),
    legend.key.size = unit(0.5, "cm"),
    legend.title = element_text(face = "bold", size = 9),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

p4 <- ggplot(test_data, aes(x = Predicted, y = Residuals)) +
  geom_point(color = "#00C853", size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = 0, color = "#D32F2F", linetype = "dashed", linewidth = 1.5) +
  geom_smooth(method = "loess", color = "#1976D2", se = FALSE, linewidth = 1.2) +
  scale_x_continuous(labels = comma) + scale_y_continuous(labels = comma) +
  labs(title = "Residuals vs Predicted Votes", x = "Predicted Votes", y = "Residuals") +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#00C853"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text = element_text(size = 9, color = "#424242"),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

p5 <- ggplot(test_data, aes(sample = Residuals)) +
  stat_qq(color = "#7B1FA2", size = 2.5, alpha = 0.8) +
  stat_qq_line(color = "#D32F2F", linewidth = 1.5) +
  labs(title = "Q-Q Plot (Normality Check)", x = "Theoretical Quantiles", y = "Sample Quantiles") +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#7B1FA2"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text = element_text(size = 9, color = "#424242"),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

p6 <- ggplot(test_data, aes(x = Residuals/1000)) +
  geom_histogram(bins = 20, fill = "#FF6F00", color = "#E65100", alpha = 0.9, linewidth = 0.8) +
  geom_vline(xintercept = 0, color = "#D32F2F", linetype = "dashed", linewidth = 1.5) +
  labs(title = "Residual Distribution", x = "Residuals (Thousands)", y = "Frequency") +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 12, color = "#FF6F00"),
    axis.title = element_text(face = "bold", size = 10, color = "#424242"),
    axis.text = element_text(size = 9, color = "#424242"),
    panel.grid.major = element_line(color = "#E0E0E0", linewidth = 0.5),
    panel.grid.minor = element_line(color = "#F5F5F5", linewidth = 0.25),
    plot.background = element_rect(fill = "white", color = "#BDBDBD", linewidth = 1.5),
    panel.background = element_rect(fill = "#FAFAFA")
  )

grid.arrange(p3, p4, p5, p6, ncol = 2)
```

## ðŸ“‘ Example Predictions

<div class="two-col">
<div>
```{r pred-table1}
example_ratings <- seq(7.5, 8.5, by = 0.5)
pred_votes <- intercept + slope * example_ratings
kable(data.frame(Rating = example_ratings, Votes = comma(round(pred_votes, 0))),
      col.names = c("IMDB Rating", "Predicted Votes"), align = c("c", "r"))
```
</div>
<div>
```{r pred-table2}
example_ratings <- seq(9.0, 9.5, by = 0.5)
pred_votes <- intercept + slope * example_ratings
kable(data.frame(Rating = example_ratings, Votes = comma(round(pred_votes, 0))),
      col.names = c("IMDB Rating", "Predicted Votes"), align = c("c", "r"))
```
</div>
</div>

## ðŸŽ¯ Key Findings

<div class="findings">
<ul>
<li><strong>Strong correlation (r = `r correlation`)</strong> between IMDB ratings and vote counts</li>
<li>Higher-rated movies consistently attract <strong>more audience engagement</strong></li>
<li>Linear regression model provides <strong>accurate predictions</strong> (RÂ² = `r r_squared`)</li>
<li>Model diagnostics confirm <strong>validity of assumptions</strong> (normality, homoscedasticity)</li>
<li>Every 1-point increase in rating predicts approximately <strong>`r comma(round(slope, 0))` more votes</strong></li>
</ul>
</div>

<div style="text-align: center; font-size: 8pt; color: #7F8C8D; margin-top: 10px; padding-top: 8px; border-top: 1px solid #ddd;">
<em>Dataset: IMDB Top 1000 Movies | All graphs and statistics generated in R | Complete code available upon request</em>
</div>